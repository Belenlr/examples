# Apply offsets to a dataset regression predictor to miminize QWK

This script applies the offsets estimated by the 
[optimize-offsets](../optimize-offsets) script to a batch prediction 
made by the predictor used to derive the offset table.

## Overview

In brief, the algorithm:

- Extracts the offset table from the execution generated by the offset
  estimation script.
- Applies the offsets to a batch prediction.

## The **inputs** for the script are:

* `dataset`: (dataset-id) Prediction dataset from which to derive offsets
* `prediction-field`: (string) Prediction name or id, or blank to use 
                               "Prediction" as default
* `execution-id`: (execution-id) Execution which supplies the offsets

The script returns the modified dataset.

## Routines

The script consists of two sets of routines.

### BigML utilities

This is a single function from the 
[repair-missing](../../repair-missing) script by Charles Parker.

* `id-from-fields`: Retrieves ID of a field given its name

### Dataset processing routines

This set of routines are the top level operations for applying
the prediction offsets to maximize the QWK statistic.

* `get-field`: Resolves field ID for a field name string.
* `extract-offsets`: Extract offset table from estimation results.
* `build-flatline`: Build flatline script (from Jao)
* `apply-offsets`: Apply prediction offsets using flatline
* `fetch-execution-result`: Fetch execution result
* `batch-corrections`: Apply offsets as batch correction

## Installation

Please see [the top-level readme](../../readme.md) for detailed installation
instructions.
